import React, { useEffect, useState } from "react";
import { asset } from "../../assets/asset";
import { useNavigate } from "react-router-dom";

const Navbar = () => {
  const [profile, setProfile] = useState(false);
  const [username, setUsername] = useState("");

  const navigate = useNavigate();

  useEffect(() => {
    const loggedInUser = sessionStorage.getItem("username") || localStorage.getItem("username");
    if(loggedInUser){
      const user = JSON.parse(loggedInUser);
      setUsername(user);
      console.log(user.email)
    }
 
  },[]);

  const handleDropdown = () => {
    setProfile((prev) => !prev);
  };

  const handleLogout = () => {
    localStorage.removeItem("username") || sessionStorage.removeItem("username");
    localStorage.removeItem("token") || sessionStorage.removeItem("token");
    navigate("/");
  }

  return (
    <div className="z-40 sticky top-0 w-full h-[100%] bg-white px-8 xl:px-10 py-4 border-b-1 border-gray-300 flex justify-between items-center">
      <div>
        <img
          src={asset.logo}
          alt="logo"
          className="h-[40px] xl:h-[60px] cursor-pointer"
        />
      </div>
      <div className="relative flex gap-6 items-center">
        {/* <svg
          width="28"
          height="29"
          viewBox="0 0 28 29"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          className="cursor-pointer"
        >
          <path
            d="M12.0458 5.53943C12.5428 3.49076 15.4572 3.49076 15.9542 5.53943C16.0287 5.8472 16.1749 6.13301 16.3808 6.3736C16.5867 6.61419 16.8465 6.80276 17.1391 6.92397C17.4317 7.04517 17.7487 7.09559 18.0644 7.07111C18.3801 7.04663 18.6856 6.94795 18.956 6.7831C20.7562 5.68643 22.8177 7.74676 21.721 9.5481C21.5564 9.81836 21.4579 10.1237 21.4334 10.4392C21.409 10.7547 21.4594 11.0715 21.5804 11.3639C21.7015 11.6563 21.8899 11.9159 22.1302 12.1218C22.3705 12.3277 22.656 12.474 22.9635 12.5488C25.0122 13.0458 25.0122 15.9601 22.9635 16.4571C22.6557 16.5317 22.3699 16.6779 22.1293 16.8838C21.8887 17.0897 21.7002 17.3495 21.579 17.642C21.4578 17.9346 21.4073 18.2516 21.4318 18.5673C21.4563 18.8831 21.555 19.1886 21.7198 19.4589C22.8165 21.2591 20.7562 23.3206 18.9548 22.2239C18.6846 22.0593 18.3793 21.9608 18.0638 21.9364C17.7483 21.9119 17.4314 21.9623 17.1391 22.0834C16.8467 22.2044 16.587 22.3928 16.3811 22.6331C16.1752 22.8734 16.0289 23.1589 15.9542 23.4664C15.4572 25.5151 12.5428 25.5151 12.0458 23.4664C11.9713 23.1587 11.8251 22.8729 11.6192 22.6323C11.4133 22.3917 11.1535 22.2031 10.8609 22.0819C10.5683 21.9607 10.2513 21.9103 9.93558 21.9347C9.61986 21.9592 9.31438 22.0579 9.044 22.2228C7.24383 23.3194 5.18233 21.2591 6.279 19.4578C6.44362 19.1875 6.54214 18.8822 6.56656 18.5667C6.59099 18.2512 6.54062 17.9344 6.41955 17.642C6.29848 17.3496 6.11014 17.0899 5.86982 16.884C5.6295 16.6781 5.34399 16.5319 5.0365 16.4571C2.98783 15.9601 2.98783 13.0458 5.0365 12.5488C5.34427 12.4742 5.63008 12.328 5.87067 12.1221C6.11126 11.9162 6.29983 11.6564 6.42104 11.3638C6.54224 11.0713 6.59266 10.7542 6.56818 10.4385C6.5437 10.1228 6.44502 9.81731 6.28017 9.54693C5.1835 7.74676 7.24383 5.68526 9.04517 6.78193C10.2118 7.49126 11.7238 6.8636 12.0458 5.53943Z"
            stroke="#656565"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M10.5 14.5029C10.5 15.4312 10.8687 16.3214 11.5251 16.9778C12.1815 17.6342 13.0717 18.0029 14 18.0029C14.9283 18.0029 15.8185 17.6342 16.4749 16.9778C17.1313 16.3214 17.5 15.4312 17.5 14.5029C17.5 13.5747 17.1313 12.6844 16.4749 12.0281C15.8185 11.3717 14.9283 11.0029 14 11.0029C13.0717 11.0029 12.1815 11.3717 11.5251 12.0281C10.8687 12.6844 10.5 13.5747 10.5 14.5029Z"
            stroke="#656565"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg> */}

        <div className="relative cursor-pointer">
          <span className="bg-red-600 rounded-full w-[10px] h-[10px] absolute top-0 right-0 animate-ping"></span>
          <svg
            width="22"
            height="27"
            viewBox="0 0 22 27"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M2.83346 9.00309C2.83346 6.83716 3.69387 4.75993 5.22542 3.22839C6.75696 1.69684 8.83419 0.836426 11.0001 0.836426C13.1661 0.836426 15.2433 1.69684 16.7748 3.22839C18.3064 4.75993 19.1668 6.83716 19.1668 9.00309V13.3944L21.2925 17.6458C21.3903 17.8414 21.4365 18.0589 21.4267 18.2774C21.4169 18.496 21.3513 18.7084 21.2363 18.8945C21.1213 19.0806 20.9606 19.2342 20.7695 19.3407C20.5784 19.4472 20.3632 19.5031 20.1445 19.5031H15.5198C15.2603 20.5044 14.6756 21.3911 13.8576 22.0242C13.0396 22.6572 12.0345 23.0007 11.0001 23.0007C9.96576 23.0007 8.96068 22.6572 8.14265 22.0242C7.32462 21.3911 6.73997 20.5044 6.48046 19.5031H1.85579C1.63701 19.5031 1.42186 19.4472 1.23077 19.3407C1.03967 19.2342 0.878983 19.0806 0.763958 18.8945C0.648933 18.7084 0.583393 18.496 0.573562 18.2774C0.563731 18.0589 0.609936 17.8414 0.707789 17.6458L2.83346 13.3944V9.00309ZM8.97945 19.5031C9.18426 19.8578 9.47881 20.1523 9.83351 20.3571C10.1882 20.5619 10.5906 20.6697 11.0001 20.6697C11.4097 20.6697 11.812 20.5619 12.1667 20.3571C12.5214 20.1523 12.816 19.8578 13.0208 19.5031H8.97945ZM11.0001 3.16976C9.45303 3.16976 7.96929 3.78434 6.87533 4.8783C5.78137 5.97227 5.16679 7.456 5.16679 9.00309V13.3944C5.16676 13.7565 5.08249 14.1136 4.92062 14.4374L3.55562 17.1698H18.4458L17.0808 14.4374C16.9185 14.1137 16.8338 13.7566 16.8335 13.3944V9.00309C16.8335 7.456 16.2189 5.97227 15.1249 4.8783C14.0309 3.78434 12.5472 3.16976 11.0001 3.16976Z"
              fill="#656565"
            />
          </svg>
        </div>

        <img
          src={asset.AuthBg}
          alt="user"
          className="w-[40px] h-[40px] rounded-full border cursor-pointer bg-violet-500"
        />
        <button onClick={handleDropdown} className="flex gap-3 items-center">
          <span className="font-[600] text-[16px] cursor-pointer border-b-1 border-gray-900">
            {username.username}
          </span>
          {profile === true ? (
            <svg
              width="11"
              height="6"
              viewBox="0 0 11 6"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M9.96434 4.50158L5.99982 0.636817C5.99982 0.636817 5.49994 0.0184993 4.88882 0.700254L1.20662 4.34545C1.05119 4.49951 0.969157 4.71717 1.01075 4.92958C1.03847 5.07204 1.12035 5.21434 1.31655 5.29288C1.80665 5.48891 2.10071 5.17522 2.10071 5.17522L5.48151 1.8682L8.88612 5.17522C8.88612 5.17522 9.28912 5.54265 9.6812 5.29288C10.0733 5.0431 10.0134 4.54943 9.96434 4.50158Z"
                fill="black"
                stroke="black"
                stroke-width="0.5"
              />
            </svg>
          ) : (
            <svg
              width="11"
              height="6"
              viewBox="0 0 11 6"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M1.03566 1.25819L5.00018 5.12295C5.00018 5.12295 5.50006 5.74127 6.11118 5.05951L9.79338 1.41432C9.94881 1.26026 10.0308 1.0426 9.98925 0.830184C9.96153 0.687727 9.87965 0.54543 9.68345 0.466888C9.19335 0.270852 8.89929 0.584542 8.89929 0.584542L5.51849 3.89156L2.11388 0.584542C2.11388 0.584542 1.71088 0.217113 1.3188 0.466888C0.926716 0.716664 0.986572 1.21033 1.03566 1.25819Z"
                fill="black"
                stroke="black"
                stroke-width="0.5"
              />
            </svg>
          )}
        </button>
        {profile && (
          <div className="absolute -bottom-11 -right-1  shadow-lg rounded-[6px] bg-white cursor-pointer max-w-60 border-1 border-gray-200">
            <ul>
              {/* <li className="rounded-t-[6px] px-5 py-2 text-[13px] font-[400] border-b-1 border-gray-200 hover:bg-[#4B215F] hover:text-white">
                 {username.email}
              </li> */}
              <li onClick={handleLogout} className="rounded-[6px] px-5 py-2 text-[13px] font-[500] border-b-1 border-gray-200 hover:bg-[#4B215F] hover:text-white">
                Logout
              </li>
            </ul>
          </div>
        )}
      </div>
    </div>
  );
};

export default Navbar;
